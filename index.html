<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Serenity Espaço Terapêutico - Controle Financeiro</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Lucide Icons as inline SVG components
        const Download = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/>
            </svg>
        );

        const Plus = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
        );

        const Trash2 = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                <line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/>
            </svg>
        );

        const TrendingUp = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/>
            </svg>
        );

        const DollarSign = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
            </svg>
        );

        const Gift = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="20 12 20 22 4 22 4 12"/><rect x="2" y="7" width="20" height="5"/>
                <line x1="12" y1="22" x2="12" y2="7"/><path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"/>
                <path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"/>
            </svg>
        );

        const Users = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/>
            </svg>
        );

        const Upload = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
            </svg>
        );

        const Filter = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>
            </svg>
        );

        const Edit2 = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/>
            </svg>
        );

        const X = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
        );

        function FinanceTracker() {
            const [transactions, setTransactions] = useState([]);
            const [newTransaction, setNewTransaction] = useState({
                date: new Date().toISOString().split('T')[0],
                description: '',
                category: '',
                type: 'service',
                paymentMethod: 'Dinheiro',
                servicePrice: '',
                masseuseName: '',
                amount: ''
            });

            const [editingId, setEditingId] = useState(null);
            const [editTransaction, setEditTransaction] = useState(null);
            const [filterMasseuse, setFilterMasseuse] = useState('all');
            const [filterPayment, setFilterPayment] = useState('all');
            const [filterDateRange, setFilterDateRange] = useState('all');
            const [showFilters, setShowFilters] = useState(false);

            const serviceCategories = [
                'Massagem Relaxante Premium', 'Massagem Relaxante Kids', 'Massagem Relaxante com Pedras Quentes',
                'Massagem com Óleo Quentes', 'Indian Head', 'Massagem Terapêutica', 'Massagem com Ventosas',
                'Liberação Miofascial', 'Massagem Desportiva', 'Reflexologia Podal', 'Massagem Craniofacial',
                'Massagem Tailandesa', 'Massagem para Gestante', 'Massagem Ayurvédica', 'Alongamento Guiado',
                'Drenagem Linfática Manual', 'Dreno Redux', 'Massagem com Bambus', 'Limpeza de pele Tradicional',
                'Limpeza de pele Premium', 'Drenagem Facial', 'Massagem Harmony', 'Dermaplaning', 'Outro'
            ];

            const expenseCategories = ['Aluguel', 'Energia/Água', 'Suprimentos', 'Salários Fixos', 'Marketing', 'Manutenção', 'Impostos', 'Outro'];
            const paymentMethods = ['Dinheiro', 'Débito', 'Crédito', 'PIX', 'Transferência', 'Vale-presente'];
            const masseuses = ['Amanda', 'Daniele', 'Luciana'];

            const calculateCommission = (price, masseuseName) => {
                let businessPercentage, masseusePercentage;
                if (masseuseName === 'Daniele') {
                    businessPercentage = 0.60;
                    masseusePercentage = 0.40;
                } else {
                    businessPercentage = 0.65;
                    masseusePercentage = 0.35;
                }
                return {
                    businessShare: price * businessPercentage,
                    masseuseShare: price * masseusePercentage
                };
            };

            const addTransaction = () => {
                let transaction;
                let validationError = '';

                if (newTransaction.type === 'service') {
                    if (!newTransaction.description) validationError = 'Selecione o tipo de serviço';
                    else if (!newTransaction.servicePrice) validationError = 'Digite o valor do serviço';
                    else if (!newTransaction.masseuseName) validationError = 'Selecione o massoterapeuta';
                    else if (!newTransaction.paymentMethod) validationError = 'Selecione a forma de pagamento';
                    
                    if (validationError) {
                        alert(validationError);
                        return;
                    }
                    
                    const price = parseFloat(newTransaction.servicePrice);
                    const { businessShare, masseuseShare } = calculateCommission(price, newTransaction.masseuseName);
                    const isGiftCard = newTransaction.paymentMethod === 'Vale-presente';
                    
                    transaction = {
                        id: Date.now(),
                        date: newTransaction.date,
                        description: newTransaction.description,
                        category: `Serviço - ${newTransaction.paymentMethod}`,
                        servicePrice: price,
                        businessRevenue: isGiftCard ? 0 : businessShare,
                        masseuseCommission: masseuseShare,
                        type: 'service',
                        paymentMethod: newTransaction.paymentMethod,
                        masseuseName: newTransaction.masseuseName,
                        isGiftCardRedemption: isGiftCard
                    };
                } else if (newTransaction.type === 'giftCardSale') {
                    if (!newTransaction.amount) {
                        alert('Digite o valor do vale-presente');
                        return;
                    }
                    transaction = {
                        id: Date.now(),
                        date: newTransaction.date,
                        description: 'Vale-presente vendido',
                        category: 'Vale-presente Vendido',
                        amount: parseFloat(newTransaction.amount),
                        type: 'giftCardSale',
                        paymentMethod: newTransaction.paymentMethod
                    };
                } else {
                    if (!newTransaction.description) validationError = 'Digite a descrição da despesa';
                    else if (!newTransaction.amount) validationError = 'Digite o valor da despesa';
                    else if (!newTransaction.category) validationError = 'Selecione a categoria';
                    
                    if (validationError) {
                        alert(validationError);
                        return;
                    }
                    transaction = {
                        id: Date.now(),
                        date: newTransaction.date,
                        description: newTransaction.description,
                        category: newTransaction.category,
                        amount: -Math.abs(parseFloat(newTransaction.amount)),
                        type: 'expense',
                        paymentMethod: newTransaction.paymentMethod
                    };
                }

                setTransactions([...transactions, transaction]);
                setNewTransaction({
                    date: new Date().toISOString().split('T')[0],
                    description: '',
                    category: '',
                    type: 'service',
                    paymentMethod: 'Dinheiro',
                    servicePrice: '',
                    masseuseName: '',
                    amount: ''
                });
            };

            const deleteTransaction = (id) => {
                if (window.confirm('Tem certeza que deseja excluir esta transação?')) {
                    setTransactions(transactions.filter(t => t.id !== id));
                }
            };

            const startEdit = (transaction) => {
                setEditingId(transaction.id);
                setEditTransaction({...transaction});
            };

            const cancelEdit = () => {
                setEditingId(null);
                setEditTransaction(null);
            };

            const saveEdit = () => {
                if (editTransaction.type === 'service') {
                    const price = parseFloat(editTransaction.servicePrice);
                    const { businessShare, masseuseShare } = calculateCommission(price, editTransaction.masseuseName);
                    const isGiftCard = editTransaction.paymentMethod === 'Vale-presente';
                    
                    editTransaction.businessRevenue = isGiftCard ? 0 : businessShare;
                    editTransaction.masseuseCommission = masseuseShare;
                    editTransaction.isGiftCardRedemption = isGiftCard;
                }

                setTransactions(transactions.map(t => t.id === editingId ? editTransaction : t));
                setEditingId(null);
                setEditTransaction(null);
            };

            const getFilteredTransactions = () => {
                let filtered = [...transactions];
                if (filterMasseuse !== 'all') filtered = filtered.filter(t => t.masseuseName === filterMasseuse);
                if (filterPayment !== 'all') filtered = filtered.filter(t => t.paymentMethod === filterPayment);
                if (filterDateRange !== 'all') {
                    const today = new Date();
                    const startDate = new Date();
                    if (filterDateRange === 'today') {
                        filtered = filtered.filter(t => t.date === today.toISOString().split('T')[0]);
                    } else if (filterDateRange === 'week') {
                        startDate.setDate(today.getDate() - 7);
                        filtered = filtered.filter(t => new Date(t.date) >= startDate);
                    } else if (filterDateRange === 'month') {
                        startDate.setMonth(today.getMonth() - 1);
                        filtered = filtered.filter(t => new Date(t.date) >= startDate);
                    }
                }
                return filtered;
            };

            const filteredTransactions = getFilteredTransactions();
            const serviceTransactions = filteredTransactions.filter(t => t.type === 'service');
            const giftCardSales = filteredTransactions.filter(t => t.type === 'giftCardSale').reduce((sum, t) => sum + t.amount, 0);
            const giftCardRedemptions = serviceTransactions.filter(t => t.isGiftCardRedemption);
            const giftCardRedemptionValue = giftCardRedemptions.reduce((sum, t) => sum + t.servicePrice, 0);
            const outstandingGiftCards = giftCardSales - giftCardRedemptionValue;
            const businessRevenueFromServices = serviceTransactions.reduce((sum, t) => sum + t.businessRevenue, 0);
            const totalBusinessRevenue = businessRevenueFromServices + giftCardSales;
            const totalCommissionsPaid = serviceTransactions.reduce((sum, t) => sum + t.masseuseCommission, 0);
            const totalExpenses = Math.abs(filteredTransactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0));
            const netProfit = totalBusinessRevenue - totalCommissionsPaid - totalExpenses;

            const today = new Date().toISOString().split('T')[0];
            const todayTransactions = transactions.filter(t => t.date === today && t.type === 'service');
            const todayRevenue = todayTransactions.reduce((sum, t) => sum + t.businessRevenue, 0);
            const todayServices = todayTransactions.length;

            const importFromCSV = (event) => {
                const file = event.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const text = e.target.result;
                        const lines = text.split('\n').slice(1);
                        const imported = lines.filter(line => line.trim()).map((line, index) => {
                            const values = line.split(',').map(v => v.replace(/^"|"$/g, '').trim());
                            const [date, type, description, category, valueService, businessRevenue, commission, masseuseName, method] = values;
                            if (type === 'Serviço') {
                                return {
                                    id: Date.now() + index, date, description, category,
                                    servicePrice: parseFloat(valueService),
                                    businessRevenue: parseFloat(businessRevenue),
                                    masseuseCommission: parseFloat(commission),
                                    type: 'service', paymentMethod: method, masseuseName,
                                    isGiftCardRedemption: method === 'Vale-presente'
                                };
                            } else if (type === 'Vale-presente') {
                                return {
                                    id: Date.now() + index, date, description, category,
                                    amount: parseFloat(valueService),
                                    type: 'giftCardSale', paymentMethod: method
                                };
                            } else if (type === 'Despesa') {
                                return {
                                    id: Date.now() + index, date, description, category,
                                    amount: -parseFloat(commission),
                                    type: 'expense', paymentMethod: method
                                };
                            }
                            return null;
                        }).filter(t => t !== null);
                        setTransactions([...transactions, ...imported]);
                        event.target.value = '';
                        alert(`${imported.length} transações importadas com sucesso!`);
                    } catch (error) {
                        alert('Erro ao importar CSV. Verifique o formato do arquivo.');
                    }
                };
                reader.readAsText(file);
            };

            const exportToCSV = () => {
                const headers = ['Data', 'Tipo', 'Descrição', 'Categoria', 'Valor Serviço', 'Receita Negócio', 'Comissão Massoterapeuta', 'Nome Massoterapeuta', 'Método'];
                const rows = transactions.map(t => {
                    if (t.type === 'service') {
                        return [t.date, 'Serviço', `"${t.description}"`, `"${t.category}"`,
                                t.servicePrice.toFixed(2), t.businessRevenue.toFixed(2),
                                t.masseuseCommission.toFixed(2), `"${t.masseuseName}"`, t.paymentMethod];
                    } else if (t.type === 'giftCardSale') {
                        return [t.date, 'Vale-presente', `"${t.description}"`, `"${t.category}"`,
                                t.amount.toFixed(2), t.amount.toFixed(2), '0.00', 'N/A', t.paymentMethod];
                    } else {
                        return [t.date, 'Despesa', `"${t.description}"`, `"${t.category}"`,
                                '0.00', '0.00', Math.abs(t.amount).toFixed(2), 'N/A', t.paymentMethod || 'Não especificado'];
                    }
                });
                const csv = [headers, ...rows].map(row => row.join(',')).join('\n');
                const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `financas-serenity-${new Date().toISOString().split('T')[0]}.csv`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-teal-50 to-blue-50 p-6">
                    <div className="max-w-7xl mx-auto">
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                            <h1 className="text-3xl font-bold text-teal-800 mb-2">Serenity Espaço Terapêutico</h1>
                            <p className="text-gray-600">Controle Financeiro - Londrina, PR</p>
                        </div>

                        <div className="bg-gradient-to-r from-indigo-500 to-purple-500 rounded-lg shadow-md p-6 mb-6 text-white">
                            <h2 className="text-xl font-bold mb-3">Resumo de Hoje</h2>
                            <div className="grid grid-cols-2 gap-4">
                                <div>
                                    <div className="text-sm opacity-90">Serviços Realizados</div>
                                    <div className="text-3xl font-bold">{todayServices}</div>
                                </div>
                                <div>
                                    <div className="text-sm opacity-90">Receita do Dia</div>
                                    <div className="text-3xl font-bold">R$ {todayRevenue.toFixed(2)}</div>
                                </div>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                            <div className="bg-gradient-to-br from-green-500 to-green-600 rounded-lg shadow-md p-6 text-white">
                                <div className="flex items-center justify-between mb-2">
                                    <span className="text-green-100">Receita Total</span>
                                    <TrendingUp />
                                </div>
                                <div className="text-2xl font-bold">R$ {totalBusinessRevenue.toFixed(2)}</div>
                            </div>
                            
                            <div className="bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg shadow-md p-6 text-white">
                                <div className="flex items-center justify-between mb-2">
                                    <span className="text-purple-100">Comissões</span>
                                    <Users />
                                </div>
                                <div className="text-2xl font-bold">R$ {totalCommissionsPaid.toFixed(2)}</div>
                            </div>

                            <div className="bg-gradient-to-br from-orange-500 to-orange-600 rounded-lg shadow-md p-6 text-white">
                                <div className="flex items-center justify-between mb-2">
                                    <span className="text-orange-100">Vales Pendentes</span>
                                    <Gift />
                                </div>
                                <div className="text-2xl font-bold">R$ {outstandingGiftCards.toFixed(2)}</div>
                            </div>
                            
                            <div className={`bg-gradient-to-br ${netProfit >= 0 ? 'from-blue-500 to-blue-600' : 'from-red-500 to-red-600'} rounded-lg shadow-md p-6 text-white`}>
                                <div className="flex items-center justify-between mb-2">
                                    <span>Lucro Líquido</span>
                                    <DollarSign />
                                </div>
                                <div className="text-2xl font-bold">R$ {netProfit.toFixed(2)}</div>
                            </div>
                        </div>

                        {/* Add Transaction Form */}
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                            <h2 className="text-2xl font-bold text-gray-800 mb-4">Adicionar Transação</h2>
                            
                            <div className="mb-4">
                                <label className="block text-sm font-medium text-gray-700 mb-2">Tipo de Transação</label>
                                <select
                                    value={newTransaction.type}
                                    onChange={(e) => setNewTransaction({...newTransaction, type: e.target.value, category: '', description: ''})}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-teal-500"
                                >
                                    <option value="service">Serviço Realizado</option>
                                    <option value="giftCardSale">Venda de Vale-presente</option>
                                    <option value="expense">Despesa</option>
                                </select>
                            </div>

                            {newTransaction.type === 'service' && (
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Data</label>
                                        <input type="date" value={newTransaction.date}
                                            onChange={(e) => setNewTransaction({...newTransaction, date: e.target.value})}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-teal-500" />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Tipo de Serviço</label>
                                        <select value={newTransaction.description}
                                            onChange={(e) => setNewTransaction({...newTransaction, description: e.target.value})}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-teal-500">
                                            <option value="">Selecione...</option>
                                            {serviceCategories.map(cat => <option key={cat} value={cat}>{cat}</option>)}
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Valor (R$)</label>
                                        <input type="number" step="0.01" value={newTransaction.servicePrice}
                                            onChange={(e) => setNewTransaction({...newTransaction, servicePrice: e.target.value})}
                                            placeholder="150.00"
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-teal-500" />
                                        {newTransaction.servicePrice && newTransaction.masseuseName && (
                                            <div className="text-xs text-gray-600 mt-1">
                                                {newTransaction.masseuseName === 'Daniele' 
                                                    ? `Negócio (60%): R$ ${(parseFloat(newTransaction.servicePrice) * 0.6).toFixed(2)} | Massoterapeuta (40%): R$ ${(parseFloat(newTransaction.servicePrice) * 0.4).toFixed(2)}`
                                                    : `Negócio (65%): R$ ${(parseFloat(newTransaction.servicePrice) * 0.65).toFixed(2)} | Massoterapeuta (35%): R$ ${(parseFloat(newTransaction.servicePrice) * 0.35).toFixed(2)}`
                                                }
                                            </div>
                                        )}
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Massoterapeuta</label>
                                        <select value={newTransaction.masseuseName}
                                            onChange={(e) => setNewTransaction({...newTransaction, masseuseName: e.target.value})}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-teal-500">
                                            <option value="">Selecione...</option>
                                            {masseuses.map(name => <option key={name} value={name}>{name}</option>)}
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Pagamento</label>
                                        <select value={newTransaction.paymentMethod}
                                            onChange={(e) => setNewTransaction({...newTransaction, paymentMethod: e.target.value})}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-teal-500">
                                            {paymentMethods.map(method => <option key={method} value={method}>{method}</option>)}
                                        </select>
                                    </div>
                                </div>
                            )}

                            {newTransaction.type === 'giftCardSale' && (
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Data</label>
                                        <input type="date" value={newTransaction.date}
                                            onChange={(e) => setNewTransaction({...newTransaction, date: e.target.value})}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md" />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Valor (R$)</label>
                                        <input type="number" step="0.01" value={newTransaction.amount}
                                            onChange={(e) => setNewTransaction({...newTransaction, amount: e.target.value})}
                                            placeholder="200.00" className="w-full px-3 py-2 border border-gray-300 rounded-md" />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Pagamento</label>
                                        <select value={newTransaction.paymentMethod}
                                            onChange={(e) => setNewTransaction({...newTransaction, paymentMethod: e.target.value})}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md">
                                            {paymentMethods.filter(m => m !== 'Vale-presente').map(method => 
                                                <option key={method} value={method}>{method}</option>
                                            )}
                                        </select>
                                    </div>
                                </div>
                            )}

                            {newTransaction.type === 'expense' && (
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Data</label>
                                        <input type="date" value={newTransaction.date}
                                            onChange={(e) => setNewTransaction({...newTransaction, date: e.target.value})}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md" />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Categoria</label>
                                        <select value={newTransaction.category}
                                            onChange={(e) => setNewTransaction({...newTransaction, category: e.target.value})}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md">
                                            <option value="">Selecione...</option>
                                            {expenseCategories.map(cat => <option key={cat} value={cat}>{cat}</option>)}
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Descrição</label>
                                        <input type="text" value={newTransaction.description}
                                            onChange={(e) => setNewTransaction({...newTransaction, description: e.target.value})}
                                            placeholder="Óleo de massagem" className="w-full px-3 py-2 border border-gray-300 rounded-md" />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Valor (R$)</label>
                                        <input type="number" step="0.01" value={newTransaction.amount}
                                            onChange={(e) => setNewTransaction({...newTransaction, amount: e.target.value})}
                                            placeholder="45.00" className="w-full px-3 py-2 border border-gray-300 rounded-md" />
                                    </div>
                                </div>
                            )}

                            <button onClick={addTransaction}
                                className="w-full md:w-auto bg-teal-600 hover:bg-teal-700 text-white font-semibold py-2 px-6 rounded-md flex items-center justify-center gap-2">
                                <Plus /> Adicionar Transação
                            </button>
                        </div>

                        {/* Transactions Table */}
                        <div className="bg-white rounded-lg shadow-lg p-6">
                            <div className="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-4">
                                <h2 className="text-2xl font-bold text-gray-800">Histórico</h2>
                                <div className="flex flex-wrap gap-2">
                                    <button onClick={() => setShowFilters(!showFilters)}
                                        className="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-4 rounded-md flex items-center gap-2">
                                        <Filter /> Filtros
                                    </button>
                                    <label className="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-md flex items-center gap-2 cursor-pointer">
                                        <Upload /> Importar CSV
                                        <input type="file" accept=".csv" onChange={importFromCSV} className="hidden" />
                                    </label>
                                    <button onClick={exportToCSV}
                                        className="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md flex items-center gap-2">
                                        <Download /> Exportar CSV
                                    </button>
                                </div>
                            </div>

                            {showFilters && (
                                <div className="bg-gray-50 p-4 rounded-lg mb-4">
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium mb-2">Massoterapeuta</label>
                                            <select value={filterMasseuse} onChange={(e) => setFilterMasseuse(e.target.value)}
                                                className="w-full px-3 py-2 border rounded-md">
                                                <option value="all">Todos</option>
                                                {masseuses.map(name => <option key={name} value={name}>{name}</option>)}
                                            </select>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-2">Pagamento</label>
                                            <select value={filterPayment} onChange={(e) => setFilterPayment(e.target.value)}
                                                className="w-full px-3 py-2 border rounded-md">
                                                <option value="all">Todos</option>
                                                {paymentMethods.map(method => <option key={method} value={method}>{method}</option>)}
                                            </select>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-2">Período</label>
                                            <select value={filterDateRange} onChange={(e) => setFilterDateRange(e.target.value)}
                                                className="w-full px-3 py-2 border rounded-md">
                                                <option value="all">Todos</option>
                                                <option value="today">Hoje</option>
                                                <option value="week">Última Semana</option>
                                                <option value="month">Último Mês</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div className="mt-3 text-sm text-gray-600">
                                        Mostrando {filteredTransactions.length} de {transactions.length} transações
                                    </div>
                                </div>
                            )}

                            <div className="overflow-x-auto">
                                <table className="w-full text-sm">
                                    <thead className="bg-gray-50">
                                        <tr>
                                            <th className="px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase">Data</th>
                                            <th className="px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase">Descrição</th>
                                            <th className="px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase">Massoterapeuta</th>
                                            <th className="px-3 py-2 text-right text-xs font-medium text-gray-700 uppercase">Valor</th>
                                            <th className="px-3 py-2 text-right text-xs font-medium text-gray-700 uppercase">Receita</th>
                                            <th className="px-3 py-2 text-right text-xs font-medium text-gray-700 uppercase">Comissão</th>
                                            <th className="px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase">Método</th>
                                            <th className="px-3 py-2 text-center text-xs font-medium text-gray-700 uppercase">Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-gray-200">
                                        {filteredTransactions.slice().reverse().map(t => (
                                            <tr key={t.id} className="hover:bg-gray-50">
                                                {editingId === t.id ? (
                                                    <>
                                                        <td className="px-3 py-2">
                                                            <input type="date" value={editTransaction.date}
                                                                onChange={(e) => setEditTransaction({...editTransaction, date: e.target.value})}
                                                                className="w-full px-2 py-1 border rounded text-sm" />
                                                        </td>
                                                        <td className="px-3 py-2">
                                                            {editTransaction.type === 'service' ? (
                                                                <select value={editTransaction.description}
                                                                    onChange={(e) => setEditTransaction({...editTransaction, description: e.target.value})}
                                                                    className="w-full px-2 py-1 border rounded text-sm">
                                                                    {serviceCategories.map(cat => <option key={cat} value={cat}>{cat}</option>)}
                                                                </select>
                                                            ) : (
                                                                <input type="text" value={editTransaction.description}
                                                                    onChange={(e) => setEditTransaction({...editTransaction, description: e.target.value})}
                                                                    className="w-full px-2 py-1 border rounded text-sm" />
                                                            )}
                                                        </td>
                                                        <td className="px-3 py-2">
                                                            {editTransaction.type === 'service' ? (
                                                                <select value={editTransaction.masseuseName}
                                                                    onChange={(e) => setEditTransaction({...editTransaction, masseuseName: e.target.value})}
                                                                    className="w-full px-2 py-1 border rounded text-sm">
                                                                    {masseuses.map(name => <option key={name} value={name}>{name}</option>)}
                                                                </select>
                                                            ) : '-'}
                                                        </td>
                                                        <td className="px-3 py-2">
                                                            {editTransaction.type === 'service' ? (
                                                                <input type="number" step="0.01" value={editTransaction.servicePrice}
                                                                    onChange={(e) => setEditTransaction({...editTransaction, servicePrice: e.target.value})}
                                                                    className="w-full px-2 py-1 border rounded text-sm text-right" />
                                                            ) : '-'}
                                                        </td>
                                                        <td className="px-3 py-2">-</td>
                                                        <td className="px-3 py-2">-</td>
                                                        <td className="px-3 py-2">
                                                            <select value={editTransaction.paymentMethod}
                                                                onChange={(e) => setEditTransaction({...editTransaction, paymentMethod: e.target.value})}
                                                                className="w-full px-2 py-1 border rounded text-sm">
                                                                {paymentMethods.map(method => <option key={method} value={method}>{method}</option>)}
                                                            </select>
                                                        </td>
                                                        <td className="px-3 py-2 text-center">
                                                            <button onClick={saveEdit} className="text-green-600 hover:text-green-800 mr-2">✓</button>
                                                            <button onClick={cancelEdit} className="text-red-600 hover:text-red-800"><X /></button>
                                                        </td>
                                                    </>
                                                ) : (
                                                    <>
                                                        <td className="px-3 py-2 text-gray-600">
                                                            {new Date(t.date).toLocaleDateString('pt-BR')}
                                                        </td>
                                                        <td className="px-3 py-2 text-gray-900">
                                                            {t.description}
                                                            {t.isGiftCardRedemption && (
                                                                <span className="ml-2 text-xs bg-orange-100 text-orange-800 px-2 py-1 rounded">Vale</span>
                                                            )}
                                                        </td>
                                                        <td className="px-3 py-2 text-gray-600">
                                                            {t.type === 'service' ? t.masseuseName : '-'}
                                                        </td>
                                                        <td className="px-3 py-2 text-right text-gray-900">
                                                            {t.type === 'service' ? `R$ ${t.servicePrice.toFixed(2)}` : 
                                                             t.type === 'giftCardSale' ? `R$ ${t.amount.toFixed(2)}` : '-'}
                                                        </td>
                                                        <td className="px-3 py-2 text-right font-semibold text-green-600">
                                                            {t.type === 'service' ? `R$ ${t.businessRevenue.toFixed(2)}` :
                                                             t.type === 'giftCardSale' ? `R$ ${t.amount.toFixed(2)}` : '-'}
                                                        </td>
                                                        <td className="px-3 py-2 text-right font-semibold text-purple-600">
                                                            {t.type === 'service' ? `R$ ${t.masseuseCommission.toFixed(2)}` :
                                                             t.type === 'expense' ? `R$ ${Math.abs(t.amount).toFixed(2)}` : '-'}
                                                        </td>
                                                        <td className="px-3 py-2 text-gray-600">{t.paymentMethod}</td>
                                                        <td className="px-3 py-2 text-center">
                                                            <button onClick={() => startEdit(t)} className="text-blue-600 hover:text-blue-800 mr-2">
                                                                <Edit2 />
                                                            </button>
                                                            <button onClick={() => deleteTransaction(t.id)} className="text-red-600 hover:text-red-800">
                                                                <Trash2 />
                                                            </button>
                                                        </td>
                                                    </>
                                                )}
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<FinanceTracker />);
    </script>
</body>
</html>
